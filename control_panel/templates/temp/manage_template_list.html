{% extends "../index.html" %}
{% block title %} Email Templates {% endblock %}
{% block content %}

<style>
    .circle-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: blue;
        color: white;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        cursor: pointer;
        position: fixed;
        bottom: 20px;
        right: 20px;
    }

    .circle-btn:hover {
        background-color: darkblue;
    }

</style>


<div class="container-fluid">
    <h1 class="h3 mb-2 text-gray-800">Email Templates</h1>
    <p class="mb-4">Manage your email templates here.</p>

<!-- Floating Add Button -->
<a href="{% url 'manage_template_create' %}" class="circle-btn">
    <i class="bi bi-plus-lg text-light"></i>
</a>


   <!-- Template Table -->
   <div class="card shadow mb-4">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Templates</h6>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table" id="dataTable" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        <th>Subject</th>
                        <th>Body</th>
                        <th>Payload</th>
                        <th>Link</th>
                        <th>Placeholders</th>                                           
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for template in templates %}
                    <tr>
                        <td>{{ template.subject }}</td>
                        <td>{{ template.body }}</td>
                        <td>{{ template.payload }}</td>
                        <td>{{ template.link }}</td>
                        <td>{{ template.placeholders }}</td>

                        <!-- {% for url in template.image_urls %}
                          <img src="{{ url }}" width="100" class="rounded border mb-2">
                        {% endfor %} -->


                        <td>
                            <a href="{% url 'manage_template_edit' template.id %}" class="text-primary edit-btn">
                                <i class="bi bi-pencil-square fs-6"></i>
                            </a>
                            
                             
                             {% if template.id %}
                             <form method="post" action="{% url 'manage_template_delete' template.id %}" style="display:inline;">
                                 {% csrf_token %}
                                 <button type="submit" class="btn text-danger btn-sm"
                                     onclick="return confirm('Are you sure you want to delete this template?');">
                                     <i class="bi bi-trash fs-6"></i>
                                 </button>
                             </form>
                             {% else %}
                                 <button class="btn btn-danger btn-sm" disabled>
                                     <i class="bi bi-trash fs-6"></i>
                                 </button>
                             {% endif %}
                             
                            
                            {% if template.id %}
                            <form method="post" action="{% url 'manage_toggle_template_active' template.id %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-sm" title="Toggle visibility"
                                        onclick="return confirm('Are you sure you want to toggle this template\'s visibility?');">
                                    {% if template.is_active %}
                                        <i class="bi bi-eye text-primary fs-6"></i>  
                                    {% else %}
                                        <i class="bi bi-eye-slash text-danger fs-6"></i>  
                                    {% endif %}
                                </button>
                            </form>
                            {% endif %}
                            
                            
                            
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>


{% endblock %}
